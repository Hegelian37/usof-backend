<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>USOF | Admin Panel</title>
    <meta name="description" content="Admin Panel">
    <link rel="stylesheet" href="/css/admin-style.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">USOF</div>
            <div class="user-info">
                <span id="adminName">Loading...</span>
                <span id="user-rating" class="user-rating">0</span>
                <div>
                    <a href="/main.html" class="btn btn-primary">Back to Main</a>
                </div>
                <div id="user-profile">
                    <a href="/profile.html" class="btn btn-primary">Profile</a>
                </div>
                <div>
                    <a href="#" class="btn btn-primary" onclick="event.preventDefault(); logout();">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <!-- BOLSHAYA ADMINSKAYA TABLITSA -- now with pagination! -- and sorting! -->
    <!-- TODO: Figure out why the hell it doesn't want to sort properly initially by id, stubbornly sorting by date instead -->
    <div class="admin-container">
        <div class="admin-tabs">
            <button class="tab-btn active" onclick="showTab('users')">Users</button>
            <button class="tab-btn" onclick="showTab('posts')">Posts</button>
            <button class="tab-btn" onclick="showTab('categories')">Categories</button>
            <button class="tab-btn" onclick="showTab('comments')">Comments</button>
        </div>

        <div id="users-tab" class="tab-content active">
            <div class="table-header">
                <h2>Manage Users</h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div class="items-per-page">
                        <label>Show: </label>
                        <select id="users-per-page" onchange="changeUsersPerPage()">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                        </select>
                        <span> entries</span>
                    </div>
                    <button onclick="openUserModal()" class="btn btn-primary">Create User</button>
                </div>
            </div>
            
            <div class="table-controls">
                <div id="users-info" class="pagination-info"></div>
            </div>
            
            <table class="data-table" id="users-table">
                <thead>
                    <tr>
                        <th onclick="sortTable('users-table', 0)" data-sort-key="id">ID</th>
                        <th onclick="sortTable('users-table', 1)" data-sort-key="login">Login</th>
                        <th onclick="sortTable('users-table', 2)" data-sort-key="full_name">Full Name</th>
                        <th onclick="sortTable('users-table', 3)" data-sort-key="email">Email</th>
                        <th onclick="sortTable('users-table', 4)" data-sort-key="status">Status</th>
                        <th onclick="sortTable('users-table', 5)" data-sort-key="rating">Rating</th>
                        <th onclick="sortTable('users-table', 6)" data-sort-key="posts_count">Posts</th>
                        <th onclick="sortTable('users-table', 7)" data-sort-key="comments_count">Comments</th>
                        <th onclick="sortTable('users-table', 8)" data-sort-key="created_at">Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <div class="pagination" id="users-pagination"></div>
        </div>

        <div id="posts-tab" class="tab-content">
            <div class="table-header">
                <h2>Manage Posts</h2>
                <div class="items-per-page">
                    <label>Show: </label>
                    <select id="posts-per-page" onchange="changePostsPerPage()">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                    <span> entries</span>
                </div>
            </div>
            
            <div class="table-controls">
                <div id="posts-info" class="pagination-info"></div>
            </div>
            
            <table class="data-table" id="posts-table">
                <thead>
                    <tr>
                        <th onclick="sortTable('posts-table', 0)" data-sort-key="id">ID</th>
                        <th onclick="sortTable('posts-table', 1)" data-sort-key="title">Title</th>
                        <th onclick="sortTable('posts-table', 2)" data-sort-key="author_login">Author</th>
                        <th onclick="sortTable('posts-table', 3)" data-sort-key="status">Status</th>
                        <th onclick="sortTable('posts-table', 4)" data-sort-key="likes_count">Likes</th>
                        <th onclick="sortTable('posts-table', 5)" data-sort-key="comments_count">Comments</th>
                        <th onclick="sortTable('posts-table', 6)" data-sort-key="created_at">Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <div class="pagination" id="posts-pagination"></div>
        </div>

        <div id="categories-tab" class="tab-content">
            <div class="table-header">
                <h2>Manage Categories</h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div class="items-per-page">
                        <label>Show: </label>
                        <select id="categories-per-page" onchange="changeCategoriesPerPage()">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                        </select>
                        <span> entries</span>
                    </div>
                    <button onclick="openCategoryModal()" class="btn btn-primary">Create Category</button>
                </div>
            </div>
            
            <div class="table-controls">
                <div id="categories-info" class="pagination-info"></div>
            </div>
            
            <table class="data-table" id="categories-table">
                <thead>
                    <tr>
                        <th onclick="sortTable('categories-table', 0)" data-sort-key="id">ID</th>
                        <th onclick="sortTable('categories-table', 1)" data-sort-key="title">Title</th>
                        <th onclick="sortTable('categories-table', 2)" data-sort-key="descript">Description</th>
                        <th onclick="sortTable('categories-table', 3)" data-sort-key="created_at">Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <div class="pagination" id="categories-pagination"></div>
        </div>

        <div id="comments-tab" class="tab-content">
            <div class="table-header">
                <h2>Manage Comments</h2>
                <div class="items-per-page">
                    <label>Show: </label>
                    <select id="comments-per-page" onchange="changeCommentsPerPage()">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                    <span> entries</span>
                </div>
            </div>
            
            <div id="comments-content">
                <p>Select a post to view its comments, or <a href="#" onclick="loadAllComments()">view all comments</a>.</p>
            </div>
        </div>
    </div>

    <!-- Modal for user editing -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('user-modal')">&times;</span>
            <h3 id="user-modal-title">Create User</h3>
            <form id="user-form">
                <div class="form-group">
                    <label>Login:</label>
                    <input type="text" name="login" required>
                </div>
                <div class="form-group">
                    <label>Full Name:</label>
                    <input type="text" name="full_name">
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" name="password" required>
                </div>
                <div class="form-group">
                    <label>Confirm Password:</label>
                    <input type="password" name="confirmPassword" required>
                </div>
                <div class="form-group">
                    <label>Role:</label>
                    <select name="status">
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>

    <!-- Modal for category editing -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('category-modal')">&times;</span>
            <h3 id="category-modal-title">Create Category</h3>
            <form id="category-form">
                <div class="form-group">
                    <label>Title:</label>
                    <input type="text" name="title" required>
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea name="descript" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>

    <script src="/js/admin-script.js"></script>
</body>
</html>